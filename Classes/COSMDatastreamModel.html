<!DOCTYPE HTML>
<html>
	<head>
		<meta http-equiv="Content-Type" content="html/html; charset=utf-8" />
		<title>COSMDatastreamModel Class Reference</title>
		<meta id="xcode-display" name="xcode-display" content="render"/>
		<meta name="viewport" content="width=550" />
		<link rel="stylesheet" type="text/css" href="../css/styles.css" media="all" />
		<link rel="stylesheet" type="text/css" media="print" href="../css/stylesPrint.css" />
		<meta name="generator" content="appledoc 2.1 (build 840)" />
	</head>
	<body>
		<header id="top_header">
			<div id="library" class="hideInXcode">
				<h1><a id="libraryTitle" href="../index.html">COSMObjectiveC </a></h1>
				<a id="developerHome" href="../index.html">COSM Ltd.</a>
			</div>
			
			<div id="title" role="banner">
				<h1 class="hideInXcode">COSMDatastreamModel Class Reference</h1>
			</div>
			<ul id="headerButtons" role="toolbar">
				<li id="toc_button">
					<button aria-label="Show Table of Contents" role="checkbox" class="open" id="table_of_contents"><span class="disclosure"></span>Table of Contents</button>
				</li>
				<li id="jumpto_button" role="navigation">
					<select id="jumpTo">
	<option value="top">Jump To&#133;</option>
	
	<option value="overview">Overview</option>
	
	
	
	
	<option value="tasks">Tasks</option>
	
	
	
	
	
	<option value="properties">Properties</option>
	
	<option value="//api/name/datapointCollection">&nbsp;&nbsp;&nbsp;&nbsp;datapointCollection</option>
	
	<option value="//api/name/feedId">&nbsp;&nbsp;&nbsp;&nbsp;feedId</option>
	
	
	
	
	
	
	<option value="instance_methods">Instance Methods</option>
	
	<option value="//api/name/fetch">&nbsp;&nbsp;&nbsp;&nbsp;- fetch</option>
	
	<option value="//api/name/init">&nbsp;&nbsp;&nbsp;&nbsp;- init</option>
	
	<option value="//api/name/isNew">&nbsp;&nbsp;&nbsp;&nbsp;- isNew</option>
	
	<option value="//api/name/parse:">&nbsp;&nbsp;&nbsp;&nbsp;- parse:</option>
	
	<option value="//api/name/resourceURLString">&nbsp;&nbsp;&nbsp;&nbsp;- resourceURLString</option>
	
	<option value="//api/name/save">&nbsp;&nbsp;&nbsp;&nbsp;- save</option>
	
	<option value="//api/name/saveableInfo">&nbsp;&nbsp;&nbsp;&nbsp;- saveableInfo</option>
	
	
	
</select>
				</li>
			</ul>
		</header>
		<nav id="tocContainer" class="isShowingTOC">
			<ul id="toc" role="tree">
				
<li role="treeitem"><span class="nodisclosure"></span><span class="sectionName"><a href="#overview">Overview</a></span></li>




<li role="treeitem" id="task_treeitem"><span class="nodisclosure"></span><span class="sectionName"><a href="#tasks">Tasks</a></span><ul>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#task_Data">Data</a></span></li>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#task_Datapoints">Datapoints</a></span></li>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#task_Synchronization">Synchronization</a></span></li>
	
</ul></li>





<li role="treeitem" class="children"><span class="disclosure"></span><span class="sectionName"><a href="#properties">Properties</a></span><ul>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/datapointCollection">datapointCollection</a></span></li>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/feedId">feedId</a></span></li>
	
</ul></li>





<li role="treeitem" class="children"><span class="disclosure"></span><span class="sectionName"><a href="#instance_methods">Instance Methods</a></span><ul>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/fetch">fetch</a></span></li>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/init">init</a></span></li>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/isNew">isNew</a></span></li>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/parse:">parse:</a></span></li>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/resourceURLString">resourceURLString</a></span></li>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/save">save</a></span></li>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/saveableInfo">saveableInfo</a></span></li>
	
</ul></li>


			</ul>
		</nav>
		<article>
			<div id="contents" class="isShowingTOC" role="main">
				<a title="COSMDatastreamModel Class Reference" name="top"></a>
				<div class="main-navigation navigation-top">
					<ul>
	<li><a href="../index.html">Index</a></li>
	<li><a href="../hierarchy.html">Hierarchy</a></li>
</ul>
				</div>
				<div id="header">
					<div class="section-header">
						<h1 class="title title-header">COSMDatastreamModel Class Reference</h1>
					</div>		
				</div>
				<div id="container">	
					
					<div class="section section-specification"><table cellspacing="0"><tbody>
						<tr>
	<td class="specification-title">Inherits from</td>
	<td class="specification-value"><a href="../Classes/COSMSubscribable.html">COSMSubscribable</a> : <a href="../Classes/COSMModel.html">COSMModel</a> : <a href="../Classes/COSMRequestable.html">COSMRequestable</a> : NSObject</td>
</tr><tr>
	<td class="specification-title">Declared in</td>
	<td class="specification-value">COSMDatastreamModel.h<br />COSMDatastreamModel.m</td>
</tr>
						</tbody></table></div>
					
					
					
					
					<div class="section section-overview">
						<a title="Overview" name="overview"></a>
						<h2 class="subtitle subtitle-overview">Overview</h2>
						<p>An Objective-C representation of a Cosm datastream which can interact with Cosm.</p>

<p>There are two main properties of a COSMDatastreamModel: a NSMutableDictionary called info which contains information relative to the datastream, and a <a href="../Classes/COSMDatapointCollection.html">COSMDatapointCollection</a> which contains the datastreams datapoints in the for of COSMDatapointModels.</p>

<p>A COSMDatastreamModel may be fetched, saved or deleted from Cosm. Also an existing COSMDatastreamModel may recieve live updates from Cosm by subscribing to updates. Updates will recieved from Cosm internally by using a web socket connection.</p>

<p>Successful or unsuccessful <a href="#//api/name/fetch">fetch</a>, <a href="#//api/name/save">save</a> and deleted requests will notify a COSMDatastreamModel delegate object by using the <a href="../Protocols/COSMModelDelegate.html">COSMModelDelegate</a> protocol. In addition to this a COSMDatastreamModel delegate object may be notified of succesful, unsuccesful or update events when the COSMDatastreamModel attempts to subscribe or is subscribed to Cosm via the <a href="../Protocols/COSMSubscribableDelegate.html">COSMSubscribableDelegate</a> protocol.</p>

<h2>Retreving a COSMDatastreamModel from Cosm.</h2>

<p>A COSMDatastreamModel can retreieved by providing a <a href="#//api/name/feedId">feedId</a>, adding the datastreams &lsquo;id&rsquo; key to the info dictionary and calling <a href="#//api/name/fetch">fetch</a>. For example:</p>

<pre><code>// Create a new datastream model
COSMDatastreamModel *myDatastream = [[COSMDatastreamModel alloc] init];

// Set the datastream's id
[myDatastream setValue:@"Temperture" forKey:@"id"];

// Also add the datastream parent feed id
myDatastream.feedId = 100;

// Finally, fetch the datastream from Cosm
[myDatastream fetch];

// ...
// Later, after feed has called `modelDidFetch:` on its delegate
NSString *currentValue = [myDatastream.info valueForKeyPath:@"current_value"];
</code></pre>

<h2>Retreving live updates of a COSMDatastreamModel from Cosm.</h2>

<p>A COSMDatastreamModel may be updated with live updates from Cosm by subscribing the COSMDatastreamModel to Cosm.</p>

<p>When subscribing a COSMDatastreamModel it should be providing a delegate conforming to the COSMDatastreamModel which will be notified when the subscribe request is successful via <code>modelDidSubscribe:</code>, when the subscribe request is unsuccessful or the socket connection drop via <code>modelDidUnsubscribe:withError:</code> or when it recieves an update via <code>modelUpdatedViaSubscription:</code>. For example, after COSMDatastreamModel has been fetched* it can be subscribed to update a UILabel with current changes:</p>

<p><em>*It is not nessicary to fetch the COSMDatastreamModel first, however without doing so there will be no information about the datastream until it is next changed on Cosm.</em></p>

<pre><code>// 0
- (IBAction)subscribeTouched:(id)sender {
   myDatastream.delegate = self;
   [myDatastream subscribe];
}

- (void)modelUpdatedViaSubscription:(COSMModel *)model {
   myLabel.text = [myDatastream.info valueForKeyPath:@"current_value"];
}

- (void)modelDidSubscribe:(COSMModel *)model {
    NSLog(@"Web socket connected, now recieving live changes to datastream");
}

- (void)modelDidUnsubscribe:(COSMModel *)model withError:(NSError *)error;
    NSLog("Web socket disconnected...");
    if (error) {
        NSLog(@"...because something went wrong");
    } else {
        NSLog(@"...because we successfully unsubscribed");
    }
}
</code></pre>

<h2>Create a new COSMDatastreamModel and <a href="#//api/name/save">save</a> it to Cosm.</h2>

<p>A new datastream can be created and saved to Cosm using the <a href="#//api/name/save">save</a> method.</p>

<p>Internally, COSMDatastreamModel will check to see if it has a valid id in its info dictionary before decideding if it should use a POST or PUT request.</p>

<pre><code>// Create a new datastream model
COSMDatastreamModel *myDatastream = [[COSMDatastreamModel alloc] init];

// Set the id
[myDatastream.info setValue:@"SoundLevel" forKey:@"id"];

// Set private
[myDatastream.info setValue:@"true" forKey:@"private"];

// Add some tags
[myDatastream.info setValue:myTagsArray forKey:@"private"];

// Save
[myDatastream save];
</code></pre>
					</div>
					
					
					
					
					
					<div class="section section-tasks">
						<a title="Tasks" name="tasks"></a>
						<h2 class="subtitle subtitle-tasks">Tasks</h2>
						
						
						<a title="Data" name="task_Data"></a>
						<h3 class="subsubtitle task-title">Data</h3>

						<ul class="task-list">
							<li>
	<span class="tooltip">
		<code><a href="#//api/name/feedId">&nbsp;&nbsp;feedId</a></code>
		
	</span>
	<span class="task-item-suffix">property</span>
	
</li>
						</ul>
						
						
						<a title="Datapoints" name="task_Datapoints"></a>
						<h3 class="subsubtitle task-title">Datapoints</h3>

						<ul class="task-list">
							<li>
	<span class="tooltip">
		<code><a href="#//api/name/datapointCollection">&nbsp;&nbsp;datapointCollection</a></code>
		
	</span>
	<span class="task-item-suffix">property</span>
	
</li>
						</ul>
						
						
						<a title="Synchronization" name="task_Synchronization"></a>
						<h3 class="subsubtitle task-title">Synchronization</h3>

						<ul class="task-list">
							<li>
	<span class="tooltip">
		<code><a href="#//api/name/fetch">&ndash;&nbsp;fetch</a></code>
		
	</span>
	
	
</li><li>
	<span class="tooltip">
		<code><a href="#//api/name/save">&ndash;&nbsp;save</a></code>
		
	</span>
	
	
</li><li>
	<span class="tooltip">
		<code><a href="#//api/name/parse:">&ndash;&nbsp;parse:</a></code>
		<span class="tooltip"><p>Parses any responce JSON into models <a href="#//api/name/info">info</a> object and or any collection the model has.</p></span>
	</span>
	
	
</li><li>
	<span class="tooltip">
		<code><a href="#//api/name/saveableInfo">&ndash;&nbsp;saveableInfo</a></code>
		<span class="tooltip"><p>returns the info dictionary without any references
to any datapoints, so that the COSMDatastreamModel
and <a href="../Classes/COSMFeedModel.html">COSMFeedModel</a> cannot make edits to any datapoints</p></span>
	</span>
	
	
</li>
						</ul>
						
						
						
						<h3 class="subsubtitle task-title">Other Methods</h3>

						<ul class="task-list">
							<li>
	<span class="tooltip">
		<code><a href="#//api/name/isNew">&ndash;&nbsp;isNew</a></code>
		<span class="tooltip"><p>Determins if the model exsits on Cosm. Normally by identifiying if it has an id.</p></span>
	</span>
	
	
</li><li>
	<span class="tooltip">
		<code><a href="#//api/name/resourceURLString">&ndash;&nbsp;resourceURLString</a></code>
		<span class="tooltip"><p>Returns the model&rsquo;s resource URL path.</p></span>
	</span>
	
	
</li><li>
	<span class="tooltip">
		<code><a href="#//api/name/init">&ndash;&nbsp;init</a></code>
		
	</span>
	
	
</li>
						</ul>
						
					</div>
					
					
					
					
					
					<div class="section section-methods">
						<a title="Properties" name="properties"></a>
						<h2 class="subtitle subtitle-methods">Properties</h2>
						
						<div class="section-method">
	<a name="//api/name/datapointCollection" title="datapointCollection"></a>
	<h3 class="subsubtitle method-title">datapointCollection</h3>
	
	
</div>
						
						<div class="section-method">
	<a name="//api/name/feedId" title="feedId"></a>
	<h3 class="subsubtitle method-title">feedId</h3>
	
	
</div>
						
					</div>
					
					
					
					
					
					<div class="section section-methods">
						<a title="Instance Methods" name="instance_methods"></a>
						<h2 class="subtitle subtitle-methods">Instance Methods</h2>
						
						<div class="section-method">
	<a name="//api/name/fetch" title="fetch"></a>
	<h3 class="subsubtitle method-title">fetch</h3>
	
	
</div>
						
						<div class="section-method">
	<a name="//api/name/init" title="init"></a>
	<h3 class="subsubtitle method-title">init</h3>
	
	
</div>
						
						<div class="section-method">
	<a name="//api/name/isNew" title="isNew"></a>
	<h3 class="subsubtitle method-title">isNew</h3>
	
	
	
	<div class="method-subsection brief-description">
		<p>Determins if the model exsits on Cosm. Normally by identifiying if it has an id.</p>
	</div>		
	
	
	<div class="method-subsection method-declaration"><code>- (BOOL)isNew</code></div>
	
	
	
	
	
	
	
	
	<div class="method-subsection discussion-section">
		<h4 class="method-subtitle">Discussion</h4>
		<p>Used internally to decide on POST or PUT request when save is called.</p>
	</div>
	
	
	
	
	
	
	
	<div class="method-subsection declared-in-section">
		<h4 class="method-subtitle">Declared In</h4>
		<code class="declared-in-ref">COSMModel.h</code><br />
	</div>				
	
	
</div>
						
						<div class="section-method">
	<a name="//api/name/parse:" title="parse:"></a>
	<h3 class="subsubtitle method-title">parse:</h3>
	
	
	
	<div class="method-subsection brief-description">
		<p>Parses any responce JSON into models <a href="#//api/name/info">info</a> object and or any collection the model has.</p>
	</div>		
	
	
	<div class="method-subsection method-declaration"><code>- (void)parse:(id)<em>JSON</em></code></div>
	
	
	
	
	
	
	
	
	<div class="method-subsection discussion-section">
		<h4 class="method-subtitle">Discussion</h4>
		<p>Should not need to be called directly. Used internally to parse responces from fetch, save, delete and subscribe requests.</p>
	</div>
	
	
	
	
	
	
	
	<div class="method-subsection declared-in-section">
		<h4 class="method-subtitle">Declared In</h4>
		<code class="declared-in-ref">COSMModel.h</code><br />
	</div>				
	
	
</div>
						
						<div class="section-method">
	<a name="//api/name/resourceURLString" title="resourceURLString"></a>
	<h3 class="subsubtitle method-title">resourceURLString</h3>
	
	
	
	<div class="method-subsection brief-description">
		<p>Returns the model&rsquo;s resource URL path.</p>
	</div>		
	
	
	<div class="method-subsection method-declaration"><code>- (NSString *)resourceURLString</code></div>
	
	
	
	
	
	
	
	
	<div class="method-subsection discussion-section">
		<h4 class="method-subtitle">Discussion</h4>
		<p>Should not need to be called directly. Used internally to create the request URL string for any fetch, save, delete and subscribe requests.</p>
	</div>
	
	
	
	
	
	
	
	<div class="method-subsection declared-in-section">
		<h4 class="method-subtitle">Declared In</h4>
		<code class="declared-in-ref">COSMModel.h</code><br />
	</div>				
	
	
</div>
						
						<div class="section-method">
	<a name="//api/name/save" title="save"></a>
	<h3 class="subsubtitle method-title">save</h3>
	
	
</div>
						
						<div class="section-method">
	<a name="//api/name/saveableInfo" title="saveableInfo"></a>
	<h3 class="subsubtitle method-title">saveableInfo</h3>
	
	
	
	<div class="method-subsection brief-description">
		<p>returns the info dictionary without any references
to any datapoints, so that the COSMDatastreamModel
and <a href="../Classes/COSMFeedModel.html">COSMFeedModel</a> cannot make edits to any datapoints</p>
	</div>		
	
	
	<div class="method-subsection method-declaration"><code>- (NSMutableDictionary *)saveableInfo</code></div>
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	<div class="method-subsection declared-in-section">
		<h4 class="method-subtitle">Declared In</h4>
		<code class="declared-in-ref">COSMDatastreamModel.h</code><br />
	</div>				
	
	
</div>
						
					</div>
					
					
				</div>
				<div class="main-navigation navigation-bottom">
					<ul>
	<li><a href="../index.html">Index</a></li>
	<li><a href="../hierarchy.html">Hierarchy</a></li>
</ul>
				</div>
				<div id="footer">
					<hr />
					<div class="footer-copyright">
						<p><span class="copyright">&copy; 2013 COSM Ltd.. All rights reserved. (Last updated: 2013-02-28)</span><br />
						
						<span class="generator">Generated by <a href="http://appledoc.gentlebytes.com">appledoc 2.1 (build 840)</a>.</span></p>
						
					</div>
				</div>
			</div>
		</article>
		<script type="text/javascript">
			function jumpToChange()
			{
				window.location.hash = this.options[this.selectedIndex].value;
			}
			
			function toggleTOC()
			{
				var contents = document.getElementById('contents');
				var tocContainer = document.getElementById('tocContainer');
				
				if (this.getAttribute('class') == 'open')
				{
					this.setAttribute('class', '');
					contents.setAttribute('class', '');
					tocContainer.setAttribute('class', '');
					
					window.name = "hideTOC";
				}
				else
				{
					this.setAttribute('class', 'open');
					contents.setAttribute('class', 'isShowingTOC');
					tocContainer.setAttribute('class', 'isShowingTOC');
					
					window.name = "";
				}
				return false;
			}
			
			function toggleTOCEntryChildren(e)
			{
				e.stopPropagation();
				var currentClass = this.getAttribute('class');
				if (currentClass == 'children') {
					this.setAttribute('class', 'children open');
				}
				else if (currentClass == 'children open') {
					this.setAttribute('class', 'children');
				}
				return false;
			}
			
			function tocEntryClick(e)
			{
				e.stopPropagation();
				return true;
			}
			
			function init()
			{
				var selectElement = document.getElementById('jumpTo');
				selectElement.addEventListener('change', jumpToChange, false);
				
				var tocButton = document.getElementById('table_of_contents');
				tocButton.addEventListener('click', toggleTOC, false);
				
				var taskTreeItem = document.getElementById('task_treeitem');
				if (taskTreeItem.getElementsByTagName('li').length > 0)
				{
					taskTreeItem.setAttribute('class', 'children');
					taskTreeItem.firstChild.setAttribute('class', 'disclosure');
				}
				
				var tocList = document.getElementById('toc');
				
				var tocEntries = tocList.getElementsByTagName('li');
				for (var i = 0; i < tocEntries.length; i++) {
					tocEntries[i].addEventListener('click', toggleTOCEntryChildren, false);
				}
				
				var tocLinks = tocList.getElementsByTagName('a');
				for (var i = 0; i < tocLinks.length; i++) {
					tocLinks[i].addEventListener('click', tocEntryClick, false);
				}
				
				if (window.name == "hideTOC") {
					toggleTOC.call(tocButton);
				}
			}
			
			window.onload = init;
		</script>
	</body>
</html>